<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŸ³é¢‘æµ‹è¯• - Puzzle Game Audio Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1a1a2e 50%, #0f172a 100%);
            color: #f1f5f9;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: #6366f1;
            margin-bottom: 30px;
        }

        .test-section {
            background: #1e293b;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(99, 102, 241, 0.2);
        }

        .test-section h2 {
            color: #10b981;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .test-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            background: #6366f1;
            color: white;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        button:hover {
            background: #8b5cf6;
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background: #64748b;
            cursor: not-allowed;
            transform: none;
        }

        .status {
            padding: 10px 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            margin-top: 10px;
        }

        .status.success {
            border-left: 4px solid #22c55e;
        }

        .status.error {
            border-left: 4px solid #ef4444;
        }

        .status.info {
            border-left: 4px solid #3b82f6;
        }

        .volume-control {
            margin-top: 15px;
        }

        .volume-control label {
            display: block;
            margin-bottom: 10px;
            color: #94a3b8;
        }

        input[type="range"] {
            width: 100%;
            max-width: 300px;
        }

        .volume-value {
            display: inline-block;
            min-width: 50px;
            text-align: right;
            font-weight: bold;
            color: #6366f1;
        }

        .log {
            background: #0f172a;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #6366f1;
            padding-left: 10px;
        }

        .log-entry.success {
            border-left-color: #22c55e;
            color: #86efac;
        }

        .log-entry.error {
            border-left-color: #ef4444;
            color: #fca5a5;
        }

        .info {
            background: rgba(59, 130, 246, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #3b82f6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸµ æ‹¼å›¾æ¸¸æˆéŸ³é¢‘ç³»ç»Ÿæµ‹è¯•</h1>

        <div class="info">
            <p>æ­¤é¡µé¢ç”¨äºæµ‹è¯•æ‹¼å›¾æ¸¸æˆçš„éŸ³é¢‘ç³»ç»ŸåŠŸèƒ½ã€‚</p>
            <p><strong>æ³¨æ„ï¼š</strong>é¦–æ¬¡æ’­æ”¾éŸ³é¢‘éœ€è¦ç”¨æˆ·äº¤äº’ï¼Œè¯·ç‚¹å‡»"åˆå§‹åŒ–éŸ³é¢‘ç³»ç»Ÿ"æŒ‰é’®ã€‚</p>
        </div>

        <!-- åˆå§‹åŒ–æµ‹è¯• -->
        <div class="test-section">
            <h2>1. éŸ³é¢‘ç³»ç»Ÿåˆå§‹åŒ–</h2>
            <div class="test-buttons">
                <button id="init-btn">åˆå§‹åŒ–éŸ³é¢‘ç³»ç»Ÿ</button>
            </div>
            <div id="init-status" class="status info">
                çŠ¶æ€: æœªåˆå§‹åŒ–
            </div>
        </div>

        <!-- éŸ³æ•ˆæµ‹è¯• -->
        <div class="test-section">
            <h2>2. éŸ³æ•ˆæµ‹è¯•</h2>
            <div class="test-buttons">
                <button id="move-sound-btn" disabled>æ’­æ”¾ç§»åŠ¨éŸ³æ•ˆ</button>
                <button id="click-sound-btn" disabled>æ’­æ”¾ç‚¹å‡»éŸ³æ•ˆ</button>
                <button id="win-sound-btn" disabled>æ’­æ”¾èƒœåˆ©éŸ³æ•ˆ</button>
            </div>
            <div id="sfx-status" class="status info">
                éŸ³æ•ˆçŠ¶æ€: æœªå°±ç»ª
            </div>
        </div>

        <!-- èƒŒæ™¯éŸ³ä¹æµ‹è¯• -->
        <div class="test-section">
            <h2>3. èƒŒæ™¯éŸ³ä¹æµ‹è¯•</h2>
            <div class="test-buttons">
                <button id="play-music-btn" disabled>æ’­æ”¾èƒŒæ™¯éŸ³ä¹</button>
                <button id="stop-music-btn" disabled>åœæ­¢èƒŒæ™¯éŸ³ä¹</button>
            </div>
            <div id="music-status" class="status info">
                èƒŒæ™¯éŸ³ä¹: åœæ­¢
            </div>
        </div>

        <!-- éŸ³é‡æ§åˆ¶æµ‹è¯• -->
        <div class="test-section">
            <h2>4. éŸ³é‡æ§åˆ¶æµ‹è¯•</h2>
            <div class="volume-control">
                <label>
                    ä¸»éŸ³é‡: <input type="range" id="master-volume" min="0" max="100" value="50">
                    <span class="volume-value" id="master-volume-value">50</span>
                </label>
            </div>
            <div class="volume-control">
                <label>
                    éŸ³æ•ˆéŸ³é‡: <input type="range" id="sfx-volume" min="0" max="100" value="60">
                    <span class="volume-value" id="sfx-volume-value">60</span>
                </label>
            </div>
            <div class="volume-control">
                <label>
                    èƒŒæ™¯éŸ³ä¹éŸ³é‡: <input type="range" id="music-volume" min="0" max="100" value="40">
                    <span class="volume-value" id="music-volume-value">40</span>
                </label>
            </div>
            <div id="volume-status" class="status info">
                å½“å‰éŸ³é‡: ä¸»éŸ³é‡ 50%, éŸ³æ•ˆ 60%, éŸ³ä¹ 40%
            </div>
        </div>

        <!-- å¼€å…³æ§åˆ¶æµ‹è¯• -->
        <div class="test-section">
            <h2>5. å¼€å…³æ§åˆ¶æµ‹è¯•</h2>
            <div class="test-buttons">
                <button id="toggle-sound-btn" disabled>åˆ‡æ¢éŸ³æ•ˆå¼€å…³</button>
                <button id="toggle-music-btn" disabled>åˆ‡æ¢éŸ³ä¹å¼€å…³</button>
            </div>
            <div id="toggle-status" class="status info">
                éŸ³æ•ˆ: å¼€å¯ | éŸ³ä¹: å…³é—­
            </div>
        </div>

        <!-- æ—¥å¿— -->
        <div class="test-section">
            <h2>æµ‹è¯•æ—¥å¿—</h2>
            <div id="log" class="log">
                <div class="log-entry">ç­‰å¾…æµ‹è¯•å¼€å§‹...</div>
            </div>
        </div>
    </div>

    <script src="audio-manager.js"></script>
    <script>
        const audioManager = new AudioManager();

        // æ—¥å¿—å·¥å…·
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            const timestamp = new Date().toLocaleTimeString();
            entry.textContent = `[${timestamp}] ${message}`;
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        // åˆå§‹åŒ–æŒ‰é’®
        document.getElementById('init-btn').addEventListener('click', async () => {
            log('å¼€å§‹åˆå§‹åŒ–éŸ³é¢‘ç³»ç»Ÿ...', 'info');

            try {
                await audioManager.init();
                log('âœ… éŸ³é¢‘ç³»ç»Ÿåˆå§‹åŒ–æˆåŠŸ', 'success');

                // æ›´æ–°çŠ¶æ€
                document.getElementById('init-status').className = 'status success';
                document.getElementById('init-status').textContent = 'çŠ¶æ€: âœ… åˆå§‹åŒ–æˆåŠŸ';

                // å¯ç”¨æŒ‰é’®
                document.getElementById('move-sound-btn').disabled = false;
                document.getElementById('click-sound-btn').disabled = false;
                document.getElementById('win-sound-btn').disabled = false;
                document.getElementById('play-music-btn').disabled = false;
                document.getElementById('toggle-sound-btn').disabled = false;
                document.getElementById('toggle-music-btn').disabled = false;

                document.getElementById('sfx-status').className = 'status success';
                document.getElementById('sfx-status').textContent = 'éŸ³æ•ˆçŠ¶æ€: âœ… å°±ç»ª';

                log('æ‰€æœ‰æµ‹è¯•æŒ‰é’®å·²å¯ç”¨', 'success');
            } catch (error) {
                log(`âŒ éŸ³é¢‘ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥: ${error.message}`, 'error');

                document.getElementById('init-status').className = 'status error';
                document.getElementById('init-status').textContent = `çŠ¶æ€: âŒ å¤±è´¥ - ${error.message}`;
            }
        });

        // ç§»åŠ¨éŸ³æ•ˆæŒ‰é’®
        document.getElementById('move-sound-btn').addEventListener('click', () => {
            audioManager.playMoveSound();
            log('ğŸµ æ’­æ”¾ç§»åŠ¨éŸ³æ•ˆ', 'success');
        });

        // ç‚¹å‡»éŸ³æ•ˆæŒ‰é’®
        document.getElementById('click-sound-btn').addEventListener('click', () => {
            audioManager.playClickSound();
            log('ğŸµ æ’­æ”¾ç‚¹å‡»éŸ³æ•ˆ', 'success');
        });

        // èƒœåˆ©éŸ³æ•ˆæŒ‰é’®
        document.getElementById('win-sound-btn').addEventListener('click', () => {
            audioManager.playWinSound();
            log('ğŸµ æ’­æ”¾èƒœåˆ©éŸ³æ•ˆ', 'success');
        });

        // æ’­æ”¾èƒŒæ™¯éŸ³ä¹æŒ‰é’®
        document.getElementById('play-music-btn').addEventListener('click', () => {
            audioManager.playBackgroundMusic();

            document.getElementById('music-status').className = 'status success';
            document.getElementById('music-status').textContent = 'èƒŒæ™¯éŸ³ä¹: âœ… æ’­æ”¾ä¸­';

            document.getElementById('stop-music-btn').disabled = false;
            log('ğŸ¶ å¼€å§‹æ’­æ”¾èƒŒæ™¯éŸ³ä¹', 'success');
        });

        // åœæ­¢èƒŒæ™¯éŸ³ä¹æŒ‰é’®
        document.getElementById('stop-music-btn').addEventListener('click', () => {
            audioManager.stopBackgroundMusic();

            document.getElementById('music-status').className = 'status info';
            document.getElementById('music-status').textContent = 'èƒŒæ™¯éŸ³ä¹: â¸ï¸ å·²åœæ­¢ï¼ˆæ·¡å‡ºä¸­ï¼‰';

            document.getElementById('stop-music-btn').disabled = true;
            log('â¸ï¸ åœæ­¢èƒŒæ™¯éŸ³ä¹ï¼ˆ2ç§’æ·¡å‡ºï¼‰', 'info');
        });

        // éŸ³é‡æ§åˆ¶
        document.getElementById('master-volume').addEventListener('input', (e) => {
            const value = e.target.value;
            document.getElementById('master-volume-value').textContent = value;
            audioManager.setMasterVolume(value);
            updateVolumeStatus();
            log(`ğŸ”Š ä¸»éŸ³é‡è®¾ç½®ä¸º ${value}%`, 'info');
        });

        document.getElementById('sfx-volume').addEventListener('input', (e) => {
            const value = e.target.value;
            document.getElementById('sfx-volume-value').textContent = value;
            audioManager.setSfxVolume(value);
            updateVolumeStatus();
            log(`ğŸ”Š éŸ³æ•ˆéŸ³é‡è®¾ç½®ä¸º ${value}%`, 'info');
        });

        document.getElementById('music-volume').addEventListener('input', (e) => {
            const value = e.target.value;
            document.getElementById('music-volume-value').textContent = value;
            audioManager.setMusicVolume(value);
            updateVolumeStatus();
            log(`ğŸ”Š éŸ³ä¹éŸ³é‡è®¾ç½®ä¸º ${value}%`, 'info');
        });

        function updateVolumeStatus() {
            const volumes = audioManager.getVolumes();
            document.getElementById('volume-status').textContent =
                `å½“å‰éŸ³é‡: ä¸»éŸ³é‡ ${volumes.master}%, éŸ³æ•ˆ ${volumes.sfx}%, éŸ³ä¹ ${volumes.music}%`;
        }

        // å¼€å…³æ§åˆ¶
        document.getElementById('toggle-sound-btn').addEventListener('click', () => {
            const enabled = audioManager.toggleSound();
            const status = enabled ? 'å¼€å¯' : 'å…³é—­';
            document.getElementById('toggle-status').textContent =
                `éŸ³æ•ˆ: ${enabled ? 'âœ… å¼€å¯' : 'âŒ å…³é—­'} | éŸ³ä¹: ${audioManager.musicEnabled ? 'âœ… å¼€å¯' : 'âŒ å…³é—­'}`;
            log(`ğŸ”‡ éŸ³æ•ˆå·²${status}`, enabled ? 'success' : 'info');
        });

        document.getElementById('toggle-music-btn').addEventListener('click', () => {
            const enabled = audioManager.toggleMusic();
            const status = enabled ? 'å¼€å¯' : 'å…³é—­';

            if (enabled) {
                document.getElementById('music-status').className = 'status success';
                document.getElementById('music-status').textContent = 'èƒŒæ™¯éŸ³ä¹: âœ… æ’­æ”¾ä¸­';
                document.getElementById('stop-music-btn').disabled = false;
            } else {
                document.getElementById('music-status').className = 'status info';
                document.getElementById('music-status').textContent = 'èƒŒæ™¯éŸ³ä¹: â¸ï¸ å·²åœæ­¢';
                document.getElementById('stop-music-btn').disabled = true;
            }

            document.getElementById('toggle-status').textContent =
                `éŸ³æ•ˆ: ${audioManager.soundEnabled ? 'âœ… å¼€å¯' : 'âŒ å…³é—­'} | éŸ³ä¹: ${enabled ? 'âœ… å¼€å¯' : 'âŒ å…³é—­'}`;
            log(`ğŸ”‡ èƒŒæ™¯éŸ³ä¹å·²${status}`, enabled ? 'success' : 'info');
        });

        log('æµ‹è¯•é¡µé¢å·²åŠ è½½ï¼Œè¯·ç‚¹å‡»"åˆå§‹åŒ–éŸ³é¢‘ç³»ç»Ÿ"å¼€å§‹æµ‹è¯•', 'info');
    </script>
</body>
</html>
